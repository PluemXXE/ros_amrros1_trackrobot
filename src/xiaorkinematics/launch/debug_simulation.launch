<?xml version="1.0" encoding="UTF-8"?>
<launch>

    <!-- ===================================================================================== -->
    <!-- |                      STEP 1: LAUNCH THE SIMULATION ENVIRONMENT                    | -->
    <!-- ===================================================================================== -->
    <!-- We still run the same Gazebo simulation as before. -->
      <include file="$(find transbot_description)/launch/gazebo_control.launch" />
      <param name="/use_sim_time" value="true"/>

    <!-- ... -->

    <!-- ===================================================================================== -->
    <!-- |                  STEP 2: LAUNCH YOUR CUSTOM INVERSE KINEMATICS DRIVER             | -->
    <!-- ===================================================================================== -->
    <!-- Run the same manual driver node. -->
    <node name="manual_driver_node"
          pkg="xiaorkinematics"
          type="manual_driver_node"
          output="screen" />


    <!-- ===================================================================================== -->
    <!-- |                      STEP 3: LAUNCH THE KEYBOARD CONTROLLER                       | -->
    <!-- ===================================================================================== -->
    <!-- We still need the keyboard to send /cmd_vel commands. -->
    <node name="teleop_twist_keyboard"
          pkg="teleop_twist_keyboard"
          type="teleop_twist_keyboard.py"
          output="screen"
          launch-prefix="gnome-terminal --" />


    <!-- ===================================================================================== -->
    <!-- |                           STEP 4: LAUNCH RVIZ FOR DEBUGGING                         | -->
    <!-- ===================================================================================== -->
    <!-- This is the new part. We launch RViz and tell it to use our saved configuration file. -->
    <node name="rviz"
          pkg="rviz"
          type="rviz"
          args="-d $(find xiaorkinematics)/rviz/debug_drive.rviz"
          required="true" />

</launch>